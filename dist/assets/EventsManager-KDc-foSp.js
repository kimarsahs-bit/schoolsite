import{r as n,g as S,a as j,j as e,B as c,A as G,m as N,X as J}from"./index-vcAYm6vD.js";import{I as u}from"./input-CVoIJ2zH.js";import{T as A}from"./textarea-B1JbTjEM.js";import{S as P,d as T,e as U,f as D,g as y}from"./select-BHw13X9t.js";import{A as K,a as Q}from"./alert-BYJYiRk6.js";import{P as W}from"./plus-CSXBcpgr.js";import{U as Y}from"./upload-DXS06rhK.js";import{S as Z}from"./save-5ZuEQXRf.js";import{C as I}from"./calendar-Cyjlwh6t.js";import{C as _}from"./clock-B1zj3MLd.js";import{M as $}from"./map-pin-WXVSP-9y.js";import{U as ee}from"./users-DshTqfGB.js";import{E as se}from"./eye-CF1wM1sA.js";import{S as te}from"./square-pen-BVw1FIsV.js";import{T as ae}from"./trash-2-04KiNg8K.js";import"./index-XrueaTAc.js";import"./chevron-down-D_kuZwQK.js";const Ne=()=>{const[o,m]=n.useState([]),[g,v]=n.useState([]),[F,x]=n.useState(!1),[t,h]=n.useState(null),[p,w]=n.useState(!1),[E,a]=n.useState(""),[f,M]=n.useState("all");n.useEffect(()=>{z(),L()},[]);const z=async()=>{try{const s=await S("royal-academy-events",[]);m(s)}catch(s){console.error("Error loading events:",s),m([]),a("Error loading events. Please refresh the page."),setTimeout(()=>a(""),3e3)}},L=async()=>{try{const s=await S("royal-academy-event-categories",[]);if(s.length===0){const l=[{id:"academic",name:"Academic",color:"#3b82f6",description:"Academic events and programs"},{id:"sports",name:"Sports",color:"#f97316",description:"Athletic and sports activities"},{id:"arts",name:"Arts",color:"#ec4899",description:"Arts and cultural events"},{id:"social",name:"Social",color:"#fbbf24",description:"Social gatherings"}];await j("royal-academy-event-categories",l),v(l)}else v(s)}catch(s){console.error("Error loading categories:",s),v([])}},B=()=>{if(g.length===0){alert("Please create at least one event category first before adding events.");return}const s={id:Date.now().toString(),title:"",description:"",fullContent:"",category:g[0].name,date:new Date().toISOString().split("T")[0],time:"10:00 AM",location:"",imageUrl:"",attendees:0,published:!1};h(s),w(!0),x(!0)},R=s=>{h({...s}),w(!1),x(!0)},V=async()=>{if(!t||!t.title.trim()){alert("Please enter an event title");return}const s=p?[...o,t]:o.map(l=>l.id===t.id?t:l);try{await j("royal-academy-events",s)?(m(s),x(!1),h(null),a(p?"Event created successfully!":"Event updated successfully!"),setTimeout(()=>a(""),3e3)):(a("Failed to save event. Please try again."),setTimeout(()=>a(""),3e3))}catch(l){console.error("Error saving event:",l),a("Error saving event. Please check your connection and try again."),setTimeout(()=>a(""),3e3)}},q=async s=>{if(confirm("Are you sure you want to delete this event?")){const l=o.filter(r=>r.id!==s);try{await j("royal-academy-events",l)?(m(l),a("Event deleted successfully!"),setTimeout(()=>a(""),3e3)):(a("Failed to delete event. Please try again."),setTimeout(()=>a(""),3e3))}catch(r){console.error("Error deleting event:",r),a("Error deleting event. Please check your connection and try again."),setTimeout(()=>a(""),3e3)}}},H=async s=>{const l=o.map(r=>r.id===s?{...r,published:!r.published}:r);try{if(await j("royal-academy-events",l)){m(l);const d=l.find(b=>b.id===s);a(d!=null&&d.published?"Event published!":"Event unpublished!"),setTimeout(()=>a(""),3e3)}else a("Failed to update event status. Please try again."),setTimeout(()=>a(""),3e3)}catch(r){console.error("Error publishing event:",r),a("Error updating event status. Please check your connection and try again."),setTimeout(()=>a(""),3e3)}},O=s=>{var r;const l=(r=s.target.files)==null?void 0:r[0];if(l&&t){const d=new FileReader;d.onload=b=>{var k;const X=(k=b.target)==null?void 0:k.result;h({...t,imageUrl:X})},d.readAsDataURL(l)}},i=(s,l)=>{t&&h({...t,[s]:l})},C=f==="all"||!f?o:o.filter(s=>s.category===f);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-heading font-bold text-foreground",children:"Events & News Manager"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Create and manage school events and news"})]}),e.jsxs(c,{onClick:B,className:"w-full sm:w-auto bg-gradient-to-r from-royal to-gold text-white",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"New Event"]})]}),E&&e.jsx(K,{children:e.jsx(Q,{children:E})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Filter by Category:"}),e.jsxs(P,{value:f,onValueChange:M,children:[e.jsx(T,{className:"w-48",children:e.jsx(U,{placeholder:"All Categories"})}),e.jsxs(D,{children:[e.jsx(y,{value:"all",children:"All Categories"}),g.map(s=>e.jsx(y,{value:s.name,children:s.name},s.id))]})]})]}),e.jsx(G,{children:F&&t&&e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(N.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-card rounded-lg sm:rounded-xl p-4 sm:p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-heading font-bold",children:p?"Create New Event":"Edit Event"}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>x(!1),className:"h-8 w-8 p-0",children:e.jsx(J,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Event Title"}),e.jsx(u,{value:t.title,onChange:s=>i("title",s.target.value),placeholder:"Enter event title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Category"}),e.jsxs(P,{value:t.category,onValueChange:s=>i("category",s),children:[e.jsx(T,{children:e.jsx(U,{})}),e.jsx(D,{children:g.map(s=>e.jsx(y,{value:s.name,children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Date"}),e.jsx(u,{type:"date",value:t.date,onChange:s=>i("date",s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Time"}),e.jsx(u,{value:t.time,onChange:s=>i("time",s.target.value),placeholder:"e.g., 10:00 AM - 4:00 PM"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Location"}),e.jsx(u,{value:t.location,onChange:s=>i("location",s.target.value),placeholder:"Enter location"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Short Description"}),e.jsx(A,{value:t.description,onChange:s=>i("description",s.target.value),placeholder:"Brief description for event card",rows:3})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Full Content (Learn More & Highlights)"}),e.jsx(A,{value:t.fullContent,onChange:s=>i("fullContent",s.target.value),placeholder:"Detailed content for 'Learn More' page. Add bullet points (one per line) for highlights section.",rows:6}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Tip: Each new line will be displayed as a highlight bullet point on the homepage"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Event Image"}),t.imageUrl&&e.jsx("div",{className:"mb-3",children:e.jsx("img",{src:t.imageUrl,alt:"Preview",className:"w-full h-48 object-cover rounded-lg border"})}),e.jsx("input",{type:"file",accept:"image/*",onChange:O,className:"hidden",id:"event-image-upload"}),e.jsx("label",{htmlFor:"event-image-upload",children:e.jsx(c,{variant:"outline",asChild:!0,className:"cursor-pointer w-full",children:e.jsxs("span",{children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),t.imageUrl?"Change Image":"Upload Image"]})})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Expected Attendees"}),e.jsx(u,{type:"number",value:t.attendees,onChange:s=>i("attendees",parseInt(s.target.value)||0),placeholder:"0"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"published",checked:t.published,onChange:s=>i("published",s.target.checked),className:"rounded"}),e.jsx("label",{htmlFor:"published",className:"text-sm",children:"Publish immediately"})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 mt-6 pt-6 border-t",children:[e.jsx(c,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsxs(c,{onClick:V,className:"bg-gradient-to-r from-royal to-gold text-white",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),p?"Create":"Update"," Event"]})]})]})})}),e.jsx("div",{className:"space-y-4",children:C.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(I,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No events created yet."}),e.jsx("p",{className:"text-sm",children:"Create your first event to get started."})]}):C.map(s=>e.jsx(N.div,{layout:!0,className:"bg-card border border-border rounded-lg overflow-hidden hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[s.imageUrl&&e.jsx("div",{className:"md:w-48 h-48 md:h-auto",children:e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 p-4 sm:p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-foreground text-lg",children:s.title}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",children:s.category}),s.published?e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300",children:"Published"}):e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300",children:"Draft"})]}),e.jsx("p",{className:"text-muted-foreground mb-3 leading-relaxed",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-muted-foreground",children:[e.jsx(I,{className:"h-4 w-4 text-gold"}),e.jsx("span",{children:new Date(s.date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-muted-foreground",children:[e.jsx(_,{className:"h-4 w-4 text-gold"}),e.jsx("span",{children:s.time})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-muted-foreground",children:[e.jsx($,{className:"h-4 w-4 text-gold"}),e.jsx("span",{children:s.location})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-muted-foreground",children:[e.jsx(ee,{className:"h-4 w-4 text-gold"}),e.jsxs("span",{children:[s.attendees," Expected"]})]})]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>H(s.id),className:s.published?"text-orange-600 hover:text-orange-700":"text-green-600 hover:text-green-700",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline ml-2",children:s.published?"Unpublish":"Publish"})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>R(s),children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline ml-2",children:"Edit"})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>q(s.id),className:"text-red-600 hover:text-red-700",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline ml-2",children:"Delete"})]})]})]})]})},s.id))})]})};export{Ne as default};
