import{c as G,u as H,r as o,j as s,m as p,B as m,l as i,g as M,a as T}from"./index-vcAYm6vD.js";import{I as c}from"./input-CVoIJ2zH.js";import{C as I,a as k,b as B,c as S,d as D}from"./card-yB6fowr0.js";import{B as $}from"./badge-LmcNerN7.js";import{A as O}from"./arrow-left-DhQ25n61.js";import{B as P}from"./bus-BTxqp6us.js";import{U as L}from"./user-plus-DbdgVC5U.js";import{E as q}from"./eye-off-DPvmRXZA.js";import{E as J}from"./eye-CF1wM1sA.js";import{P as K}from"./phone-CcjDqeo4.js";import{R as E}from"./refresh-cw-CAHL2gzR.js";import{S as Y}from"./save-5ZuEQXRf.js";import{C as N}from"./copy-Bub14O3W.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=G("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),A="royal-academy-auth-buses",ns=()=>{const w=H(),[j,h]=o.useState(!1),[g,U]=o.useState(!1),[r,b]=o.useState(!1),[t,f]=o.useState(null),[e,v]=o.useState({username:"",password:"",routeName:"",busNumber:"",driverName:"",driverPhone:""}),n=a=>{const{name:l,value:d}=a.target;v(C=>({...C,[l]:d}))},R=()=>{const a=Date.now().toString().slice(-6),l=Math.floor(Math.random()*1e3).toString().padStart(3,"0"),d=`BUS${a}${l}`;f({busId:d}),i.success("Bus ID generated successfully")},u=(a,l)=>{navigator.clipboard.writeText(a).then(()=>i.success(`${l} copied`))},F=async()=>{if(!(t!=null&&t.busId)){i.error("Please generate a Bus ID first");return}if(!e.username||!e.password){i.error("Username and Password are required");return}h(!0);try{const a=(localStorage.getItem("principalEmail")||"principal.1025@gmail.com").trim().toLowerCase(),l=await M(A,[]);if((l||[]).filter(x=>(x.owner||"").toLowerCase()===a).some(x=>x.busId===t.busId||(x.username||"").toLowerCase()===e.username.toLowerCase())){i.error("A bus with this ID or username already exists"),h(!1);return}const z={id:t.busId,busId:t.busId,username:e.username,password:e.password,status:"active",createdAt:new Date().toISOString(),routeName:e.routeName,busNumber:e.busNumber,driverName:e.driverName,driverPhone:e.driverPhone,owner:a};await T(A,[...l||[],z]),b(!0),i.success("Bus tracking ID created")}catch(a){console.error(a),i.error("Failed to create bus ID")}h(!1)},y=()=>{v({username:"",password:"",routeName:"",busNumber:"",driverName:"",driverPhone:""}),f(null),b(!1)};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-royal via-royal/90 to-gold/20 p-2 sm:p-3 md:p-4",children:s.jsxs("div",{className:"w-full max-w-7xl mx-auto",children:[s.jsxs(p.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 mb-4 sm:mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[s.jsx(m,{variant:"ghost",size:"icon",onClick:()=>w("/principal-dashboard"),className:"rounded-full h-8 w-8 sm:h-9 sm:w-9 flex-shrink-0",children:s.jsx(O,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white truncate",children:"Create Bus Tracking ID"}),s.jsx("p",{className:"text-xs sm:text-sm text-white/80 truncate",children:"Generate login for bus tracker"})]})]}),s.jsxs($,{variant:"secondary",className:"bg-white/10 text-white border-white/20 text-xs sm:text-sm whitespace-nowrap",children:[s.jsx(P,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),"New Bus"]})]}),s.jsxs("div",{className:"grid gap-4 sm:gap-6 lg:grid-cols-2",children:[s.jsx(p.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:s.jsxs(I,{className:"bg-card/95 backdrop-blur-md border-border/50",children:[s.jsxs(k,{className:"p-3 sm:p-6",children:[s.jsxs(B,{className:"flex items-center gap-2 text-base sm:text-lg",children:[s.jsx(L,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),"Bus Account"]}),s.jsx(S,{className:"text-xs sm:text-sm",children:"Fill details and generate credentials"})]}),s.jsxs(D,{className:"space-y-3 sm:space-y-4 p-3 sm:p-6 pt-0 sm:pt-0",children:[s.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[s.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Username *"}),s.jsx(c,{name:"username",value:e.username,onChange:n,placeholder:"tracker.username",disabled:r,className:"text-xs sm:text-sm h-8 sm:h-9"})]}),s.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[s.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Password *"}),s.jsxs("div",{className:"relative",children:[s.jsx(c,{name:"password",type:g?"text":"password",value:e.password,onChange:n,placeholder:"Strong password",className:"pr-10 text-xs sm:text-sm h-8 sm:h-9",disabled:r}),s.jsx("button",{type:"button",onClick:()=>U(a=>!a),className:"absolute right-2 top-1/2 -translate-y-1/2",children:g?s.jsx(q,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}):s.jsx(J,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-4",children:[s.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[s.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Route Name"}),s.jsx(c,{name:"routeName",value:e.routeName,onChange:n,placeholder:"Route A / Downtown",disabled:r,className:"text-xs sm:text-sm h-8 sm:h-9"})]}),s.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[s.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Bus Number"}),s.jsxs("div",{className:"relative",children:[s.jsx(_,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 sm:h-4 sm:w-4 text-muted-foreground"}),s.jsx(c,{name:"busNumber",value:e.busNumber,onChange:n,placeholder:"e.g. RJ14-1234",className:"pl-8 text-xs sm:text-sm h-8 sm:h-9",disabled:r})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-4",children:[s.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[s.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Driver Name"}),s.jsx(c,{name:"driverName",value:e.driverName,onChange:n,placeholder:"Name",disabled:r,className:"text-xs sm:text-sm h-8 sm:h-9"})]}),s.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[s.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Driver Phone"}),s.jsxs("div",{className:"relative",children:[s.jsx(K,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 sm:h-4 sm:w-4 text-muted-foreground"}),s.jsx(c,{name:"driverPhone",value:e.driverPhone,onChange:n,placeholder:"+91-...",className:"pl-8 text-xs sm:text-sm h-8 sm:h-9",disabled:r})]})]})]}),!r&&s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-1 sm:pt-2",children:[s.jsxs(m,{onClick:R,className:"flex-1 text-xs sm:text-sm h-8 sm:h-9",children:[s.jsx(E,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),"Generate Bus ID"]}),s.jsxs(m,{onClick:F,disabled:!e.username||!e.password||!t||j,className:"flex-1 text-xs sm:text-sm h-8 sm:h-9",children:[j?s.jsx(E,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2 animate-spin"}):s.jsx(Y,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),"Create Account"]})]})]})]})}),s.jsx(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},children:s.jsxs(I,{className:"bg-card/95 backdrop-blur-md border-border/50",children:[s.jsxs(k,{className:"p-3 sm:p-6",children:[s.jsxs(B,{className:"flex items-center gap-2 text-base sm:text-lg",children:[s.jsx(P,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),"Generated Credentials"]}),s.jsx(S,{className:"text-xs sm:text-sm",children:"Share with the assigned tracker"})]}),s.jsx(D,{className:"p-3 sm:p-6 pt-0 sm:pt-0",children:t?s.jsxs("div",{className:"space-y-2 sm:space-y-4",children:[s.jsxs("div",{className:"p-2.5 sm:p-4 bg-muted/20 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Bus ID"}),s.jsx(m,{variant:"ghost",size:"sm",onClick:()=>u(t.busId,"Bus ID"),className:"h-6 w-6 sm:h-8 sm:w-8 p-0",children:s.jsx(N,{className:"h-3 w-3 sm:h-4 sm:w-4"})})]}),s.jsx("p",{className:"font-mono text-sm sm:text-lg font-bold text-primary break-all",children:t.busId})]}),s.jsxs("div",{className:"p-2.5 sm:p-4 bg-muted/20 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Username"}),s.jsx(m,{variant:"ghost",size:"sm",onClick:()=>u(e.username,"Username"),className:"h-6 w-6 sm:h-8 sm:w-8 p-0",children:s.jsx(N,{className:"h-3 w-3 sm:h-4 sm:w-4"})})]}),s.jsx("p",{className:"font-mono text-sm sm:text-lg break-all",children:e.username||"—"})]}),s.jsxs("div",{className:"p-2.5 sm:p-4 bg-muted/20 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Password"}),s.jsx(m,{variant:"ghost",size:"sm",onClick:()=>u(e.password,"Password"),className:"h-6 w-6 sm:h-8 sm:w-8 p-0",children:s.jsx(N,{className:"h-3 w-3 sm:h-4 sm:w-4"})})]}),s.jsx("p",{className:"font-mono text-sm sm:text-lg",children:e.password?"••••••••":"—"})]}),s.jsx("div",{className:"flex flex-col sm:flex-row gap-2 pt-1 sm:pt-2",children:r?s.jsxs(s.Fragment,{children:[s.jsx(m,{onClick:()=>w("/manage-bus-id"),className:"flex-1 text-xs sm:text-sm h-8 sm:h-9",children:"Manage Bus IDs"}),s.jsx(m,{variant:"outline",onClick:y,className:"flex-1 text-xs sm:text-sm h-8 sm:h-9",children:"Create Another"})]}):s.jsx(m,{variant:"outline",onClick:y,className:"w-full text-xs sm:text-sm h-8 sm:h-9",children:"Reset"})})]}):s.jsxs("div",{className:"text-center py-8 sm:py-12 text-muted-foreground",children:[s.jsx(L,{className:"h-8 w-8 sm:h-12 sm:w-12 mx-auto mb-2 sm:mb-4 opacity-50"}),s.jsx("p",{className:"text-xs sm:text-sm",children:"Fill in the details and generate credentials to see them here"})]})})]})})]})]})})};export{ns as default};
