import{r as c,u as w,j as t,m as p,B as g}from"./index-vcAYm6vD.js";import v from"./DocumentViewer-B-12NAZG.js";import{A as S}from"./arrow-left-DhQ25n61.js";import{B as h}from"./bell-D_AoMh8q.js";import{G as A}from"./graduation-cap-P36faES5.js";import{U as k}from"./user-BFMo7NJs.js";import"./button-variants-BtDv6DLU.js";import"./zoom-out-Bm9_1osx.js";import"./download-DqcvXZsi.js";import"./copy-Bub14O3W.js";import"./share-2-6yjGy1yT.js";const L=()=>{const[a,N]=c.useState(null),[d,m]=c.useState([]),[y,i]=c.useState(!1),[n,u]=c.useState(null),f=w();c.useEffect(()=>{const e=localStorage.getItem("currentStudent"),l=localStorage.getItem("studentEmail");if(e)try{const r=JSON.parse(e),s={id:r.studentId||r.id,fullName:r.username||r.name||r.fullName,email:r.email||l,rollNumber:r.rollNumber||"N/A",class:r.class||"N/A",section:r.section||"A"};N(s)}catch{console.log("Error parsing currentStudent")}},[]),c.useEffect(()=>{if(a){const e=localStorage.getItem("royal-academy-student-notifications");if(e){const r=JSON.parse(e).filter(s=>s.targetType==="all"||s.targetType==="class"&&s.targetClass===a.class||s.targetType==="section"&&s.targetClass===a.class&&s.targetSection===a.section||s.targetType==="student"&&s.targetStudentId===a.id);m(r)}}},[a]);const b=e=>{const l=d.map(o=>o.id===e?{...o,status:"read"}:o);m(l);const s=JSON.parse(localStorage.getItem("royal-academy-student-notifications")||"[]").map(o=>o.id===e?{...o,status:"read"}:o);localStorage.setItem("royal-academy-student-notifications",JSON.stringify(s))},j=()=>{const e=d.map(s=>({...s,status:"read"}));m(e);const r=JSON.parse(localStorage.getItem("royal-academy-student-notifications")||"[]").map(s=>s.targetType==="all"||s.targetType==="class"&&s.targetClass===(a==null?void 0:a.class)||s.targetType==="section"&&s.targetClass===(a==null?void 0:a.class)&&s.targetSection===(a==null?void 0:a.section)||s.targetType==="student"&&s.targetStudentId===(a==null?void 0:a.id)?{...s,status:"read"}:s);localStorage.setItem("royal-academy-student-notifications",JSON.stringify(r))},x=d.filter(e=>e.status==="unread").length;return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20",children:[t.jsx(p.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-card/95 backdrop-blur-md border-b border-border/50 sticky top-0 z-50",children:t.jsx("div",{className:"container-wide py-3 sm:py-4 px-3 sm:px-4",children:t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsxs(g,{variant:"ghost",onClick:()=>f(-1),className:"flex items-center space-x-2 text-foreground hover:text-gold h-8 sm:h-auto px-2 sm:px-3",children:[t.jsx(S,{className:"h-4 w-4"}),t.jsx("span",{className:"text-sm",children:"Back"})]}),t.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[t.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-gradient-to-r from-red-500 to-pink-500 flex items-center justify-center",children:t.jsx(h,{className:"h-4 w-4 sm:h-5 sm:w-5 text-white"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("h1",{className:"text-lg sm:text-xl font-heading font-bold text-foreground truncate",children:"ðŸ“¢ Notifications"}),t.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:x>0?`${x} unread messages`:"All caught up!"})]})]}),x>0&&t.jsx(g,{variant:"outline",size:"sm",onClick:j,className:"text-xs sm:text-sm h-8 sm:h-10",children:"Mark All Read"})]})})}),t.jsx("div",{className:"container-wide py-4 sm:py-6 px-3 sm:px-4",children:t.jsx(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-card/95 backdrop-blur-md rounded-xl border border-border/50 overflow-hidden",children:d.length===0?t.jsxs("div",{className:"p-8 text-center",children:[t.jsx("div",{className:"w-16 h-16 rounded-full bg-muted/50 flex items-center justify-center mx-auto mb-4",children:t.jsx(h,{className:"h-8 w-8 text-muted-foreground"})}),t.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No Notifications"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"You'll see messages from teachers and principal here."})]}):t.jsx("div",{className:"divide-y divide-border/30",children:d.sort((e,l)=>new Date(l.createdAt).getTime()-new Date(e.createdAt).getTime()).map((e,l)=>t.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1+l*.05},className:`p-4 sm:p-6 hover:bg-muted/30 transition-colors ${e.status==="unread"?"bg-blue-500/5 border-l-4 border-l-blue-500":""}`,children:t.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-gradient-to-r from-royal/20 to-gold/20 flex items-center justify-center",children:e.senderType==="principal"?t.jsx(A,{className:"h-5 w-5 sm:h-6 sm:w-6 text-royal"}):t.jsx(k,{className:"h-5 w-5 sm:h-6 sm:w-6 text-royal"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2 gap-2",children:[t.jsx("h4",{className:"text-sm sm:text-base font-semibold text-foreground break-words flex-1",children:e.subject}),e.status==="unread"&&t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-500/20 text-blue-400 flex-shrink-0",children:"New"})]}),t.jsxs("p",{className:"text-xs sm:text-sm text-blue-400 mb-2",children:["From: ",e.senderName," (",e.senderType==="principal"?"Principal":"Teacher",")"]}),t.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mb-3 break-words",children:e.message}),(e.photo1||e.photo2)&&t.jsxs("div",{className:"flex space-x-3 mb-3",children:[e.photo1&&t.jsx("img",{src:e.photo1,alt:"Attachment 1",className:"w-16 h-16 sm:w-20 sm:h-20 object-cover rounded-lg border cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>{u({src:e.photo1,title:`${e.subject} - Attachment 1`}),i(!0)}}),e.photo2&&t.jsx("img",{src:e.photo2,alt:"Attachment 2",className:"w-16 h-16 sm:w-20 sm:h-20 object-cover rounded-lg border cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>{u({src:e.photo2,title:`${e.subject} - Attachment 2`}),i(!0)}})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2",children:[t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsxs("span",{className:"text-xs text-muted-foreground",children:[new Date(e.createdAt).toLocaleDateString()," â€¢ ",new Date(e.createdAt).toLocaleTimeString()]}),t.jsxs("span",{className:"text-xs text-muted-foreground",children:["Target: ",e.targetType==="all"?"All Students":e.targetType==="class"?`Class ${e.targetClass}`:e.targetType==="section"?`Class ${e.targetClass}-${e.targetSection}`:"Individual"]})]}),e.status==="unread"&&t.jsx(g,{variant:"ghost",size:"sm",onClick:()=>b(e.id),className:"text-xs text-blue-600 hover:text-blue-700 h-8",children:"Mark as Read"})]})]})]})},e.id))})})}),y&&n&&t.jsx(v,{documentUrl:n.src,documentName:n.title,onClose:()=>{i(!1),u(null)}})]})};export{L as default};
