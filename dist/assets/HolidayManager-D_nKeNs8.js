import{r,j as e,m as p,B as n,g as A,a as w}from"./index-vcAYm6vD.js";import{I as f}from"./input-CVoIJ2zH.js";import{T as O}from"./textarea-B1JbTjEM.js";import{C as v,a as b,b as D,c as C,d as S}from"./card-yB6fowr0.js";import{L as c}from"./label-CYmdnxUg.js";import{U as F}from"./upload-DXS06rhK.js";import{C as H}from"./calendar-Cyjlwh6t.js";import{D as R}from"./download-DqcvXZsi.js";import{T as B}from"./trash-2-04KiNg8K.js";const V=()=>{const[o,m]=r.useState([]),[U,y]=r.useState(!0),[g,j]=r.useState(!1),[k,x]=r.useState(!1),d=r.useRef(null),[l,h]=r.useState({title:"",description:"",date:"",file:null});r.useEffect(()=>{(async()=>{try{y(!0);const t=await A("royal-academy-holidays",[]);m(t||[])}catch(t){console.error("Error loading holiday data:",t)}finally{y(!1)}})()},[]);const u=a=>{const{name:t,value:s}=a.target;h(i=>({...i,[t]:s}))},E=a=>{var s;const t=(s=a.target.files)==null?void 0:s[0];t&&h(i=>({...i,file:t}))},I=()=>{var a;(a=d.current)==null||a.click()},L=async a=>{var t;if(a.preventDefault(),!l.date){alert("Please select a date for the holiday");return}j(!0),x(!1);try{const s=l.file?URL.createObjectURL(l.file):"",i={id:Math.random().toString(36).substr(2,9),title:l.title,description:l.description,date:l.date,fileUrl:s,fileName:((t=l.file)==null?void 0:t.name)||"",uploadedAt:new Date().toISOString()},N=[...o,i];await w("royal-academy-holidays",N),m(N),x(!0),h({title:"",description:"",date:"",file:null}),d.current&&(d.current.value=""),setTimeout(()=>x(!1),3e3)}catch(s){console.error("Error saving holiday:",s),alert("Failed to save holiday. Please try again.")}finally{j(!1)}},T=async a=>{if(window.confirm("Are you sure you want to delete this holiday?"))try{const t=o.filter(s=>s.id!==a);await w("royal-academy-holidays",t),m(t)}catch(t){console.error("Error deleting holiday:",t),alert("Failed to delete holiday. Please try again.")}},M=(a,t)=>{if(!a){alert("No file available for download");return}const s=document.createElement("a");s.href=a,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-heading font-bold text-foreground mb-2",children:"Holiday Manager"}),e.jsx("p",{className:"text-muted-foreground",children:"Upload and manage holiday notices and documents"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8",children:[e.jsx(p.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},children:e.jsxs(v,{children:[e.jsxs(b,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"Add New Holiday"]}),e.jsx(C,{children:"Upload holiday notices and related documents"})]}),e.jsx(S,{children:e.jsxs("form",{onSubmit:L,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"title",children:"Holiday Title"}),e.jsx(f,{id:"title",name:"title",value:l.title,onChange:u,placeholder:"e.g., Winter Break",required:!0,className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"date",children:"Date"}),e.jsx(f,{id:"date",name:"date",type:"date",value:l.date,onChange:u,required:!0,className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"description",children:"Description"}),e.jsx(O,{id:"description",name:"description",value:l.description,onChange:u,placeholder:"Describe the holiday...",rows:3,required:!0,className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Upload Document (Optional)"}),e.jsx(f,{type:"file",accept:".pdf,.doc,.docx",onChange:E,ref:d,className:"hidden"}),e.jsxs("div",{className:"flex flex-col items-start gap-2",children:[e.jsxs(n,{type:"button",onClick:I,className:"bg-gradient-to-r from-gold to-yellow-500 text-white font-bold hover:from-gold/90 hover:to-yellow-500/90 text-sm sm:text-base w-full sm:w-auto",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Choose File"]}),e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground break-all",children:l.file?l.file.name:"No file chosen"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Supported formats: PDF, DOC, DOCX. Maximum file size: 10MB"})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx(n,{type:"submit",disabled:g,className:"w-full bg-gradient-to-r from-gold to-yellow-500 text-white font-bold hover:from-gold/90 hover:to-yellow-500/90",children:g?"Saving...":"Save Holiday"}),k&&e.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-3 p-3 bg-green-500/10 border border-green-500/30 rounded-lg text-green-600 text-center",children:"Holiday saved successfully!"})]})]})})]})}),e.jsx(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1},children:e.jsxs(v,{children:[e.jsxs(b,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5"}),"Upcoming Holidays"]}),e.jsx(C,{children:"Manage existing holiday notices"})]}),e.jsx(S,{children:U?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gold"})}):o.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(H,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"No holidays added yet"})]}):e.jsx("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2",children:o.map(a=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-4 border border-border rounded-lg hover:bg-muted/10 transition-colors gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium text-foreground truncate text-sm sm:text-base",children:a.title}),e.jsx("span",{className:"text-xs bg-gold/10 text-gold px-2 py-1 rounded-full whitespace-nowrap",children:new Date(a.date).toLocaleDateString()})]}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground line-clamp-2 mb-2",children:a.description}),e.jsxs("div",{className:"flex flex-wrap items-center text-xs text-muted-foreground gap-1",children:[e.jsxs("span",{children:["Added: ",new Date(a.uploadedAt).toLocaleDateString()]}),a.fileName&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"truncate",children:a.fileName})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.fileName&&e.jsx(n,{variant:"outline",size:"sm",onClick:()=>M(a.fileUrl,a.fileName),className:"h-8 w-8 p-0 sm:h-9 sm:w-9",title:"Download",children:e.jsx(R,{className:"h-4 w-4"})}),e.jsx(n,{variant:"destructive",size:"sm",onClick:()=>T(a.id),className:"h-8 w-8 p-0 sm:h-9 sm:w-9",title:"Delete",children:e.jsx(B,{className:"h-4 w-4"})})]})]},a.id))})})]})})]})]})};export{V as default};
