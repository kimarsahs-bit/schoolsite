import{u as S,r as n,j as e,m as c,B as I,g as E,a as g}from"./index-vcAYm6vD.js";import{I as f}from"./input-CVoIJ2zH.js";import{A as L,a as A}from"./alert-BYJYiRk6.js";import{B as C}from"./bus-BTxqp6us.js";import{C as B}from"./circle-alert-D_zFa0RS.js";import{E as P}from"./eye-off-DPvmRXZA.js";import{E as D}from"./eye-CF1wM1sA.js";const m="royal-academy-auth-buses",K=()=>{const b=S(),[u,w]=n.useState(""),[p,y]=n.useState(""),[d,j]=n.useState(!1),[h,r]=n.useState(""),[x,o]=n.useState(!1),v=async t=>{t.preventDefault(),o(!0),r("");try{const i=await E(m,[]),s=(i||[]).find(a=>(a.username||"").trim().toLowerCase()===u.trim().toLowerCase());if(!s){r("Invalid username or password."),o(!1);return}if(s.status==="banned"||s.status==="suspended"){r("Your account is not active. Contact the Principal."),o(!1);return}if((s.password||"")!==p){const a=(i||[]).map(l=>l.id===s.id?{...l,loginAttempts:(l.loginAttempts||0)+1}:l);await g(m,a),r("Invalid username or password."),o(!1);return}localStorage.setItem("busAuth","true"),localStorage.setItem("busUsername",s.username),localStorage.setItem("busId",s.busId),localStorage.setItem("busUserId",s.id);const N=(i||[]).map(a=>a.id===s.id?{...a,lastLogin:new Date().toISOString(),loginAttempts:0}:a);await g(m,N),b("/bus-dashboard",{replace:!0})}catch{r("Login failed. Please try again.")}o(!1)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-royal via-royal/90 to-gold/20 flex items-center justify-center p-4",children:e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-card/95 backdrop-blur-md rounded-2xl shadow-2xl border border-border/50 p-6 sm:p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(c.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-r from-royal to-gold flex items-center justify-center",children:e.jsx(C,{className:"h-8 w-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-heading font-bold text-foreground mb-2",children:"Bus Tracker Login"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Enter your credentials to continue"})]}),h&&e.jsx(c.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6",children:e.jsxs(L,{variant:"destructive",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx(A,{children:h})]})}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"username",className:"text-sm font-medium text-foreground",children:"Username"}),e.jsx(f,{id:"username",value:u,onChange:t=>w(t.target.value),placeholder:"Enter your username",className:"h-12",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"password",className:"text-sm font-medium text-foreground",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(f,{id:"password",type:d?"text":"password",value:p,onChange:t=>y(t.target.value),placeholder:"Enter your password",className:"h-12 pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>j(t=>!t),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground","aria-label":d?"Hide password":"Show password",children:d?e.jsx(P,{className:"h-4 w-4"}):e.jsx(D,{className:"h-4 w-4"})})]})]}),e.jsx(I,{type:"submit",disabled:x,className:"w-full h-12 bg-gradient-to-r from-royal to-gold text-white",children:x?"Signing inâ€¦":"Sign In"})]})]})})})};export{K as default};
