import{r,j as e,m as p,B as m,g as B,a as b}from"./index-vcAYm6vD.js";import{I as f}from"./input-CVoIJ2zH.js";import{T as O}from"./textarea-B1JbTjEM.js";import{S as R,d as A,e as z,f as q,g as V}from"./select-BHw13X9t.js";import{C as N,a as w,b as v,c as S,d as D}from"./card-yB6fowr0.js";import{L as n}from"./label-CYmdnxUg.js";import{U as C}from"./upload-DXS06rhK.js";import{B as F}from"./book-open-Cck4FFnk.js";import{D as H}from"./download-DqcvXZsi.js";import{T as W}from"./trash-2-04KiNg8K.js";import"./index-XrueaTAc.js";import"./chevron-down-D_kuZwQK.js";const le=()=>{const[c,u]=r.useState([]),[U,g]=r.useState(!0),[j,y]=r.useState(!1),[P,x]=r.useState(!1),o=r.useRef(null),[t,d]=r.useState({class:"1",title:"",description:"",subject:"",file:null});r.useEffect(()=>{(async()=>{try{g(!0);const a=await B("royal-academy-syllabus",[]);u(a||[])}catch(a){console.error("Error loading syllabus data:",a)}finally{g(!1)}})()},[]);const h=s=>{const{name:a,value:l}=s.target;d(i=>({...i,[a]:l}))},k=(s,a)=>{d(l=>({...l,[s]:a}))},I=s=>{var l;const a=(l=s.target.files)==null?void 0:l[0];a&&d(i=>({...i,file:a}))},M=()=>{var s;(s=o.current)==null||s.click()},T=async s=>{if(s.preventDefault(),!t.file){alert("Please select a PDF file to upload");return}if(!t.file.name.toLowerCase().endsWith(".pdf")){alert("Please upload a PDF file");return}y(!0),x(!1);try{const a=URL.createObjectURL(t.file),l={id:Math.random().toString(36).substr(2,9),class:parseInt(t.class),title:t.title,description:t.description,fileUrl:a,fileName:t.file.name,uploadedAt:new Date().toISOString(),subject:t.subject||void 0},i=[...c,l];await b("royal-academy-syllabus",i),u(i),x(!0),d({class:"1",title:"",description:"",subject:"",file:null}),o.current&&(o.current.value=""),setTimeout(()=>x(!1),3e3)}catch(a){console.error("Error saving syllabus:",a),alert("Failed to save syllabus. Please try again.")}finally{y(!1)}},E=async s=>{if(window.confirm("Are you sure you want to delete this syllabus?"))try{const a=c.filter(l=>l.id!==s);await b("royal-academy-syllabus",a),u(a)}catch(a){console.error("Error deleting syllabus:",a),alert("Failed to delete syllabus. Please try again.")}},L=(s,a)=>{const l=document.createElement("a");l.href=s,l.download=a,document.body.appendChild(l),l.click(),document.body.removeChild(l)};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-heading font-bold text-foreground mb-2",children:"Syllabus Manager"}),e.jsx("p",{className:"text-muted-foreground",children:"Upload and manage syllabus documents for different classes"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8",children:[e.jsx(p.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},children:e.jsxs(N,{children:[e.jsxs(w,{children:[e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5"}),"Upload New Syllabus"]}),e.jsx(S,{children:"Upload PDF syllabus documents for different classes (1-12)"})]}),e.jsx(D,{children:e.jsxs("form",{onSubmit:T,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"class",children:"Class"}),e.jsxs(R,{value:t.class,onValueChange:s=>k("class",s),children:[e.jsx(A,{children:e.jsx(z,{placeholder:"Select class"})}),e.jsx(q,{children:Array.from({length:12},(s,a)=>a+1).map(s=>e.jsxs(V,{value:s.toString(),children:["Class ",s]},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"subject",children:"Subject (Optional)"}),e.jsx(f,{id:"subject",name:"subject",value:t.subject,onChange:h,placeholder:"e.g., Mathematics",className:"text-sm"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"title",children:"Title"}),e.jsx(f,{id:"title",name:"title",value:t.title,onChange:h,placeholder:"e.g., Class 10 Mathematics",required:!0,className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(O,{id:"description",name:"description",value:t.description,onChange:h,placeholder:"Describe the syllabus...",rows:3,required:!0,className:"text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Upload PDF File"}),e.jsx(f,{type:"file",accept:".pdf",onChange:I,ref:o,className:"hidden"}),e.jsxs("div",{className:"flex flex-col items-start gap-2",children:[e.jsxs(m,{type:"button",onClick:M,className:"bg-gradient-to-r from-gold to-yellow-500 text-white font-bold hover:from-gold/90 hover:to-yellow-500/90 text-sm sm:text-base w-full sm:w-auto",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Choose PDF File"]}),e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground break-all",children:t.file?t.file.name:"No file chosen"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Only PDF files are allowed. Maximum file size: 10MB"})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx(m,{type:"submit",disabled:j,className:"w-full bg-gradient-to-r from-gold to-yellow-500 text-white font-bold hover:from-gold/90 hover:to-yellow-500/90",children:j?"Uploading...":"Upload Syllabus"}),P&&e.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-3 p-3 bg-green-500/10 border border-green-500/30 rounded-lg text-green-600 text-center",children:"Syllabus uploaded successfully!"})]})]})})]})}),e.jsx(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1},children:e.jsxs(N,{children:[e.jsxs(w,{children:[e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"Uploaded Syllabus"]}),e.jsx(S,{children:"Manage existing syllabus documents"})]}),e.jsx(D,{children:U?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gold"})}):c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(F,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"No syllabus documents uploaded yet"})]}):e.jsx("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2",children:c.map(s=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-4 border border-border rounded-lg hover:bg-muted/10 transition-colors gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium text-foreground truncate text-sm sm:text-base",children:s.title}),e.jsxs("span",{className:"text-xs bg-gold/10 text-gold px-2 py-1 rounded-full whitespace-nowrap",children:["Class ",s.class]})]}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground line-clamp-2 mb-2",children:s.description}),e.jsxs("div",{className:"flex flex-wrap items-center text-xs text-muted-foreground gap-1",children:[e.jsx("span",{children:new Date(s.uploadedAt).toLocaleDateString()}),s.subject&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{children:s.subject})]}),e.jsx("span",{className:"hidden sm:inline",children:"•"}),e.jsx("span",{className:"truncate",children:s.fileName})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>L(s.fileUrl,s.fileName),className:"h-8 w-8 p-0 sm:h-9 sm:w-9",title:"Download",children:e.jsx(H,{className:"h-4 w-4"})}),e.jsx(m,{variant:"destructive",size:"sm",onClick:()=>E(s.id),className:"h-8 w-8 p-0 sm:h-9 sm:w-9",title:"Delete",children:e.jsx(W,{className:"h-4 w-4"})})]})]},s.id))})})]})})]})]})};export{le as default};
