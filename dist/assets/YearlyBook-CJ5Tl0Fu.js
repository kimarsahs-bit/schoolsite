import{u as P,r as l,s as R,j as e,m as i,B as d}from"./index-vcAYm6vD.js";import{N as U}from"./Navigation-CkWS-LtT.js";import{F as V}from"./Footer-BiycIaLE.js";import{l as q}from"./booksHelper-CI04GjtC.js";import{S as k,d as C,e as S,f as B,g as x}from"./select-BHw13X9t.js";import{C as G,a as H,b as M,c as O,d as $,e as J}from"./card-yB6fowr0.js";import{B as Y}from"./badge-LmcNerN7.js";import{A as K}from"./arrow-left-DhQ25n61.js";import{B as h}from"./book-open-Cck4FFnk.js";import{F as Q}from"./filter-Cf7tfofv.js";import{G as W}from"./graduation-cap-P36faES5.js";import{U as X}from"./user-BFMo7NJs.js";import{M as Z}from"./minus-D_KMDVYG.js";import{P as ee}from"./plus-CSXBcpgr.js";import{I as se}from"./info-DY3hXfGU.js";import{E as ae}from"./external-link-D61icv-P.js";import{A as te}from"./arrow-up-DqqWJMn0.js";import"./button-variants-BtDv6DLU.js";import"./useTranslation-FKcwN8er.js";import"./house-ClAQJ8-A.js";import"./users-DshTqfGB.js";import"./calendar-Cyjlwh6t.js";import"./building-C8rHFNgL.js";import"./camera-Bc_Ov7XJ.js";import"./trophy-B-XvrowL.js";import"./chevron-down-D_kuZwQK.js";import"./globe-BWhPOJAF.js";import"./bell-D_AoMh8q.js";import"./phone-CcjDqeo4.js";import"./mail-MYJrtdEn.js";import"./award-Bdl_Spfw.js";import"./map-pin-WXVSP-9y.js";import"./index-XrueaTAc.js";const Ie=()=>{const F=P(),[p,u]=l.useState([]),[f,j]=l.useState([]),[E,y]=l.useState(!0),[o,b]=l.useState("all"),[r,g]=l.useState("all"),[T,N]=l.useState([]),[v,A]=l.useState({}),[L,z]=l.useState(!1);l.useEffect(()=>{(async()=>{y(!0);const a=await q();u(a),j(a);const n=Array.from(new Set(a.map(c=>c.year))).sort();N(n),y(!1)})();const t=R("royal-academy-yearly-books",a=>{console.log("[YearlyBook] Received realtime update"),u(a);const n=Array.from(new Set(a.map(c=>c.year))).sort();N(n)});return()=>{t()}},[]),l.useEffect(()=>{const s=()=>{z(window.scrollY>400)};return window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)},[]);const D=()=>{window.scrollTo({top:0,behavior:"smooth"})};l.useEffect(()=>{let s=p;o!=="all"&&(s=s.filter(t=>t.class===parseInt(o))),r!=="all"&&(s=s.filter(t=>t.year===r)),j(s)},[o,r,p]);const w=()=>{b("all"),g("all")},_=s=>{A(t=>({...t,[s]:!t[s]}))},m=f.reduce((s,t)=>(s[t.class]||(s[t.class]=[]),s[t.class].push(t),s),{}),I=Object.keys(m).map(Number).sort((s,t)=>s-t);return e.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[e.jsx(U,{}),e.jsxs("section",{className:"relative pt-20 pb-8 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-royal/20 via-background to-gold/20"}),e.jsxs("div",{className:"yearly-book-container relative z-10",children:[e.jsx(i.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:0},className:"mb-4",children:e.jsxs(d,{variant:"ghost",onClick:()=>F(-1),className:"back-btn flex items-center space-x-2",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx("span",{children:"Back"})]})}),e.jsxs(i.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:0},className:"text-center mb-6",children:[e.jsx("div",{className:"flex items-center justify-center mb-3",children:e.jsx(h,{className:"h-10 w-10 text-gold animate-pulse"})}),e.jsx("h1",{className:"text-2xl font-heading font-bold mb-3 yearly-book-title",children:e.jsx("span",{className:"text-gradient-gold",children:"Yearly Book Collection"})}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-[340px] mx-auto leading-relaxed",children:"Discover our recommended books for each class. Browse by grade level or academic year to find the perfect reading materials for your studies."})]})]})]}),e.jsx("section",{className:"py-4 border-b border-border bg-muted/20",children:e.jsx("div",{className:"yearly-book-container",children:e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0},className:"flex flex-col items-start gap-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{className:"h-4 w-4 text-gold"}),e.jsx("h2",{className:"text-base font-semibold",children:"Filter Books"})]}),e.jsxs("div",{className:"flex flex-col items-stretch gap-3 w-full",children:[e.jsxs(k,{value:o,onValueChange:b,children:[e.jsx(C,{className:"w-full",children:e.jsx(S,{placeholder:"Select Class"})}),e.jsxs(B,{position:"popper",side:"bottom",align:"start",className:"max-h-60 overflow-y-auto",children:[e.jsx(x,{value:"all",children:"All Classes"}),[1,2,3,4,5,6,7,8,9,10,11,12].map(s=>e.jsxs(x,{value:s.toString(),children:["Class ",s]},s))]})]}),e.jsxs(k,{value:r,onValueChange:g,children:[e.jsx(C,{className:"w-full",children:e.jsx(S,{placeholder:"Select Year"})}),e.jsxs(B,{position:"popper",side:"bottom",align:"start",className:"max-h-60 overflow-y-auto",children:[e.jsx(x,{value:"all",children:"All Years"}),T.map(s=>e.jsx(x,{value:s,children:s},s))]})]}),(o!=="all"||r!=="all")&&e.jsx(d,{variant:"outline",size:"sm",onClick:w,className:"w-full",children:"Reset Filters"})]})]})})}),e.jsx("section",{className:"py-6",children:e.jsx("div",{className:"yearly-book-container",children:E?e.jsx("div",{className:"flex items-center justify-center py-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gold mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Loading books..."})]})}):f.length===0?e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0},className:"text-center py-10",children:[e.jsx(h,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Books Found"}),e.jsx("p",{className:"text-muted-foreground mb-4 text-sm",children:o!=="all"||r!=="all"?"Try adjusting your filters to see more books.":"No books have been added yet. Check back soon!"}),(o!=="all"||r!=="all")&&e.jsx(d,{onClick:w,variant:"outline",size:"sm",children:"Clear Filters"})]}):e.jsx("div",{className:"space-y-8",children:I.map((s,t)=>e.jsxs(i.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:0,delay:t*0},children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(W,{className:"h-5 w-5 text-gold"}),e.jsxs("h2",{className:"text-xl font-heading font-bold",children:["Class ",s]}),e.jsxs(Y,{variant:"secondary",className:"text-xs",children:[m[s].length," ",m[s].length===1?"book":"books"]})]}),e.jsx("div",{className:"h-1 w-16 bg-gradient-to-r from-gold to-royal rounded-full"})]}),e.jsx("div",{className:"yearly-book-grid",children:m[s].map((a,n)=>e.jsx(i.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:0,delay:n*0},whileHover:{scale:1.02},children:e.jsxs(G,{className:"yearly-book-card h-full flex flex-col hover:shadow-xl transition-all duration-300 border-border hover:border-gold/50",children:[a.cover_photo&&e.jsx("div",{className:"relative w-full h-48 overflow-hidden rounded-t-lg",children:e.jsx("img",{src:a.cover_photo,alt:a.title,className:"w-full h-full object-cover",onError:c=>{c.currentTarget.style.display="none"}})}),e.jsxs(H,{className:"yearly-book-header p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx(h,{className:"h-6 w-6 text-gold flex-shrink-0"}),e.jsx(Y,{variant:"outline",className:"text-xs",children:a.year})]}),e.jsx(M,{className:"text-base font-semibold line-clamp-2 yearly-book-title",children:a.title}),e.jsxs(O,{className:"flex items-center space-x-1 mt-2 yearly-book-author",children:[e.jsx(X,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:a.author})]})]}),e.jsxs($,{className:"yearly-book-content flex-grow px-4 pb-2",children:[e.jsx("div",{className:"sm:hidden mb-2",children:e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>_(a.id),className:"w-full flex items-center justify-between border-gold/30 text-gold hover:bg-gold/10",children:[e.jsx("span",{className:"text-xs",children:"Book Description"}),v[a.id]?e.jsx(Z,{className:"h-3 w-3"}):e.jsx(ee,{className:"h-3 w-3"})]})}),e.jsx("div",{className:`${v[a.id]?"block":"hidden sm:block"}`,children:e.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[e.jsx(se,{className:"h-3 w-3 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed yearly-book-description",children:a.description})]})})]}),e.jsx(J,{className:"yearly-book-footer px-4 pb-4 pt-2 border-t border-border",children:e.jsxs(d,{className:"w-full bg-gradient-to-r from-gold to-yellow-500 hover:from-gold/90 hover:to-yellow-500/90 text-black font-semibold text-sm h-9",onClick:()=>window.open(a.buying_link,"_blank","noopener,noreferrer"),children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),"Buy Now"]})})]})},a.id))})]},s))})})}),L&&e.jsx(i.button,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},onClick:D,className:"fixed bottom-8 right-8 z-50 p-3 rounded-full bg-gold hover:bg-gold/90 text-black shadow-lg hover:shadow-xl transition-all duration-300","aria-label":"Scroll to top",children:e.jsx(te,{className:"h-6 w-6"})}),e.jsx(V,{})]})};export{Ie as default};
