import{u as G,r as m,j as e,B as c,A as Q,m as L,X as V,l as u}from"./index-vcAYm6vD.js";import{I as $}from"./input-CVoIJ2zH.js";import{B as b,T as X,a as q,b as y,c as x,d as K,e as i,A as M,g as B,f as P}from"./avatar-CGCYeeC4.js";import{B as E}from"./badge-LmcNerN7.js";import{C as j,a as f,b as p,d as g,c as Y}from"./card-yB6fowr0.js";import{U as J}from"./user-plus-DbdgVC5U.js";import{S as Z}from"./search-DaWYlKik.js";import{E as _}from"./eye-CF1wM1sA.js";import{T as O}from"./trash-2-04KiNg8K.js";import{M as ee}from"./mail-MYJrtdEn.js";import{P as se}from"./phone-CcjDqeo4.js";import{G as te}from"./graduation-cap-P36faES5.js";import{C as ae}from"./calendar-Cyjlwh6t.js";const pe=()=>{const z=G(),[d,N]=m.useState([]),[v,H]=m.useState(""),[U,T]=m.useState(!0),[a,S]=m.useState(null),[F,C]=m.useState(!1);m.useEffect(()=>{const s=()=>{try{const o=JSON.parse(localStorage.getItem("royal-academy-teachers")||"[]").map(n=>({id:n.id,name:n.name,email:n.email,subject:n.subject,phone:n.phone||"N/A",assignedClass:n.assignedClass||"N/A",assignedSection:n.assignedSection||"N/A",status:["active","suspended","banned"].includes(n.status)?n.status:"active",joinDate:n.createdAt||new Date().toISOString(),teacherId:n.teacherId||n.id,avatar:n.avatar}));N(o),T(!1)}catch(t){console.error("Error loading teachers:",t),N([]),T(!1)}};s();const l=t=>{t.key==="royal-academy-teachers"&&s()};return window.addEventListener("storage",l),()=>window.removeEventListener("storage",l)},[]);const k=d.filter(s=>s.name.toLowerCase().includes(v.toLowerCase())||s.email.toLowerCase().includes(v.toLowerCase())||s.subject.toLowerCase().includes(v.toLowerCase())),A=s=>{const l=d.map(t=>{if(t.id===s){const o=t.status==="banned"?"active":"banned";return{...t,status:o}}return t});N(l);try{const o=JSON.parse(localStorage.getItem("royal-academy-teachers")||"[]").map(r=>r.id===s?{...r,status:r.status==="banned"?"active":"banned"}:r);localStorage.setItem("royal-academy-teachers",JSON.stringify(o));const D=JSON.parse(localStorage.getItem("royal-academy-auth-teachers")||"[]").map(r=>r.id===s||r.teacherId===s?{...r,status:r.status==="banned"?"active":"banned"}:r);localStorage.setItem("royal-academy-auth-teachers",JSON.stringify(D));const h=l.find(r=>r.id===s);u.success(`Teacher ${(h==null?void 0:h.status)==="banned"?"banned":"unbanned"} successfully`)}catch(t){console.error("Error updating teacher status:",t),u.error("Failed to update teacher status")}},I=s=>{const l=d.find(t=>t.id===s);if(window.confirm(`Are you sure you want to permanently delete ${l==null?void 0:l.name}? This action cannot be undone.`))try{const t=d.filter(r=>r.id!==s);N(t);const n=JSON.parse(localStorage.getItem("royal-academy-teachers")||"[]").filter(r=>r.id!==s);localStorage.setItem("royal-academy-teachers",JSON.stringify(n));const h=JSON.parse(localStorage.getItem("royal-academy-auth-teachers")||"[]").filter(r=>r.id!==s&&r.teacherId!==s);localStorage.setItem("royal-academy-auth-teachers",JSON.stringify(h)),u.success("Teacher deleted successfully")}catch(t){console.error("Error deleting teacher:",t),u.error("Failed to delete teacher")}},R=()=>{z("/principal-dashboard"),u.info("Redirecting to Principal Dashboard to create teacher account")},W=s=>{S(s),C(!0)},w=()=>{C(!1),S(null)};return e.jsxs("div",{className:"container mx-auto p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Teacher Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage all teachers and their accounts"})]}),e.jsxs(c,{onClick:R,className:"gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"Add New Teacher"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[e.jsxs(j,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Total Teachers"}),e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",className:"h-4 w-4 text-muted-foreground",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"})]})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total registered teachers"})]})]}),e.jsxs(j,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Active Teachers"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",className:"h-4 w-4 text-muted-foreground",children:e.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.filter(s=>s.status==="active").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently active"})]})]}),e.jsxs(j,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Banned Teachers"}),e.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.filter(s=>s.status==="banned").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Accounts suspended"})]})]}),e.jsxs(j,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"New This Month"}),e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",className:"h-4 w-4 text-muted-foreground",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"})]})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.filter(s=>{const l=new Date(s.joinDate),t=new Date;return t.setMonth(t.getMonth()-1),l>=t}).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Since last month"})]})]})]}),e.jsxs(j,{children:[e.jsx(f,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(p,{children:"Teachers List"}),e.jsx(Y,{children:"Manage all teacher accounts and permissions"})]}),e.jsxs("div",{className:"relative w-full sm:w-auto",children:[e.jsx(Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx($,{type:"search",placeholder:"Search teachers...",className:"w-full sm:w-64 pl-8",value:v,onChange:s=>H(s.target.value)})]})]})}),e.jsx(g,{children:U?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(X,{children:[e.jsx(q,{children:e.jsxs(y,{children:[e.jsx(x,{children:"Teacher"}),e.jsx(x,{children:"Subject"}),e.jsx(x,{children:"Class/Section"}),e.jsx(x,{children:"Status"}),e.jsx(x,{children:"Join Date"}),e.jsx(x,{className:"text-right",children:"Actions"})]})}),e.jsx(K,{children:k.length>0?k.map(s=>e.jsxs(y,{children:[e.jsx(i,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(M,{className:"h-9 w-9",children:[e.jsx(B,{src:s.avatar,alt:s.name}),e.jsx(P,{children:s.name.split(" ").map(l=>l[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.email})]})]})}),e.jsx(i,{children:s.subject}),e.jsx(i,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:s.assignedClass}),e.jsxs("div",{className:"text-muted-foreground",children:["Section ",s.assignedSection]})]})}),e.jsx(i,{children:e.jsx(E,{variant:s.status==="banned"?"destructive":s.status==="suspended"?"secondary":"default",children:s.status==="banned"?"Banned":s.status==="suspended"?"Suspended":"Active"})}),e.jsx(i,{children:new Date(s.joinDate).toLocaleDateString()}),e.jsx(i,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>A(s.id),title:s.status==="banned"?"Unban Teacher":"Ban Teacher",className:s.status==="banned"?"text-green-600 hover:text-green-700":"text-red-600 hover:text-red-700",children:e.jsx(b,{className:"h-4 w-4"})}),e.jsx(c,{variant:"ghost",size:"icon",title:"View Profile",onClick:()=>W(s),children:e.jsx(_,{className:"h-4 w-4"})}),e.jsx(c,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",onClick:()=>I(s.id),title:"Delete Teacher",children:e.jsx(O,{className:"h-4 w-4"})})]})})]},s.id)):e.jsx(y,{children:e.jsx(i,{colSpan:6,className:"h-24 text-center",children:"No teachers found."})})})]})})})]}),e.jsx(Q,{children:F&&a&&e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:w,children:e.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-card rounded-2xl shadow-2xl border border-border/50 w-full max-w-md",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border/50",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Teacher Profile"}),e.jsx(c,{variant:"ghost",size:"icon",onClick:w,className:"rounded-full",children:e.jsx(V,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center text-center space-y-4",children:[e.jsxs(M,{className:"h-20 w-20",children:[e.jsx(B,{src:a.avatar,alt:a.name}),e.jsx(P,{className:"text-lg",children:a.name.split(" ").map(s=>s[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:a.name}),e.jsxs("p",{className:"text-muted-foreground",children:[a.subject," Teacher"]}),e.jsx(E,{variant:a.status==="banned"?"destructive":a.status==="suspended"?"secondary":"default",className:"mt-2",children:a.status==="banned"?"Banned":a.status==="suspended"?"Suspended":"Active"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/20 rounded-lg",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Email"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.email})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/20 rounded-lg",children:[e.jsx(se,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Phone"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.phone})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/20 rounded-lg",children:[e.jsx(te,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Assigned Class"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.assignedClass," - Section ",a.assignedSection]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/20 rounded-lg",children:[e.jsx(ae,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Join Date"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(a.joinDate).toLocaleDateString()})]})]}),a.teacherId&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/20 rounded-lg",children:[e.jsx(J,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Teacher ID"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.teacherId})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{A(a.id),w()},className:a.status==="banned"?"text-green-600 hover:text-green-700":"text-red-600 hover:text-red-700",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),a.status==="banned"?"Unban":"Ban"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{I(a.id),w()},className:"text-destructive hover:text-destructive",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})})})]})};export{pe as default};
